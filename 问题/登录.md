### 名词

- 认证（Authentication）
  - 验证当前用户的身份
- 授权（Authorization）
  - 用户授予第三方应用访问该用户某些资源的权限
  - 实现授权的方式有：cookie、session、token、OAuth
- 凭证（Credentials）
  - 游客模式和登录模式
  - 令牌（token）

### Cookie & Session

- Cookie
  - HTTP 是无状态的协议
  - 客户端 cookie
    - httpOnly
    - expires
- Session
  - 记录服务器和客户端会话状态的机制
  - 基于 cookie 实现
  - session 在服务器端（共享），sessionId 在客户端 cookie 中
- Cookie 和 Session 的区别
  - 安全性
  - 存取值的类型
  - 有效期
  - 存储大小

### Token & JWT

- Token（令牌）
  - Acesss Token
    - 访问资源接口（API）时所需要的资源凭证
    - 组成：uid+time+sign（身份）
    - 特点
      - 避开同源策略（token 是无状态的，可以在多个服务间共享）
      - 避免 CSRF 攻击
      - token 放到请求头里
      - 时效性（过期时间）
      - 跨平台（IOS/Android）
  - Refresh Token
    - 用于刷新 access token
    - 有效期较长
    - 刷新 access token 时验证
- Token 和 Session 的区别
  - 会话状态和 API 访问凭证
  - 第三方和内部
  - 移动端对 cookie 的支持不是很好
- JWT
  - JSON Web Token, 跨域认证方案
  - 认证授权机制
  - SHA256 算法
  - Base64URL 算法
  - 使用方式：请求头或请求体
  - 使用 HMAC 算法或者是 RSA 的公/私秘钥对 JWT 进行签名

```java
Header.Payload.Signature
```

- Token 和 JWT 的区别

  - 相同
    - 访问资源
    - 记录用户信息
    - 服务端无状态化
    - 资源保护
  - 不同
    - Token 需要查询数据库，获取用户信息
    - JWT 自包含了用户信息和加密的数据

- 前后端鉴权方式

  - Session-Cookie
  - Token 验证（包括 JWT，SSO）
  - OAuth2.0（开放授权）

- 哈希算法
  - 又称摘要算法（Digest）
    - 对任意一组输入数据进行计算，得到一个 固定长度 的输出摘要
  - 验证原始数据是否被篡改
    - 相同的输入一定得到相同的输出
    - 不同的输入大概率得到不同的输出
  - 哈希碰撞
    - 无限的输入集合映射到一个有限的输出集合，必然会产生碰撞
    - 碰撞概率低
    - 不能猜测输出
  - 常用（输出越长越安全）
    - md5
    - sha1
    - SHA-256
    - SHA-512
  - 用途
    - 下载软件页面 hash
    - 存储用户口令
      - 彩虹表（字典）
      - 加盐（salt）

### 总结

- cookie

  - 存储在客户端，易被篡改
  - httpOnly 提高安全性
  - 体积不能超过 4kb
  - 无法跨域
  - 移动端对 cookie 的支持不是很好

- session

  - 会占据较多的内存（服务器保存 session）
  - 集群部署，数据共享
  - 基于 cookie

- token
  - 查询时间，redis（键值对(Key-Value)存储数据库）
  - 避开同源策略
  - 避免 CSRF 攻击
  - 移动端常用的是 token
