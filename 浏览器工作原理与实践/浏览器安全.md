### 网页安全

- 同源策略
  - DOM 层面
    - window.open 或 a 标签
    - window.opener
  - 数据层面
    - cookie
    - storage
    - indexDB
  - 网络层面
    - XMLHttpRequest
- 浏览器出让的同源策略
  - 页面中可以嵌入第三方资源
    - XSS 攻击与 CSP（内容安全策略）
  - 跨域资源共享（CORS）
  - 跨文档消息机制
    - window.postMessage

```java
// CSP
Content-Security-Policy: default-src 'self' *.trusted.com
```

- XSS

  - 跨站脚本攻击（Cross Site Scripting）
  - 注入类型
    - 存储型 XSS 攻击（服务器端存储恶意代码）
    - 反射型 XSS 攻击
      - 客户端->服务端->客户端
      - 根据请求参数，服务端渲染（参数）
    - 基于 DOM 的 XSS 攻击（修改 html）
  - 阻止 XSS 攻击
    - 服务器对输入脚本进行过滤或转码
    - 充分利用 CSP
      - 资源下载限制（js）
      - 资源请求限制（xhr,fetch）
      - 内联脚本限制
      - 上报机制
    - 使用 HttpOnly 属性
    - 验证码机制（用户确认）

- CSRF
  - 跨站请求伪造（Cross-site request forgery）
    - 第三方 cookie
    - 在第三方站点可以请求目标的服务器器地址，这时会带上目标站点的用户 Cookie 登陆态信息
  - 利用用户登录态，操作
    - GET
    - POST
    - a 链接
  - 阻止 CSRF
    - SameSite
    - 验证请求的来源站点（Referer 和 Origin）
      - Referer 包含路径
    - CSRF Token
